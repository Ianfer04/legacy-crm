<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>LegacyCRM ‚Äî Panel</title>
  <link rel="stylesheet" href="styles.css" />
  
  <style>
    /* MEJORA 1: Agrupamiento (Barra de progreso) */
    .progress-container {
      margin-bottom: 20px;
      padding: 15px;
      background: rgba(0,0,0,0.2);
      border-radius: 6px;
      border: 1px solid var(--border);
    }
    .progress-bar {
      height: 8px;
      background: rgba(255,255,255,0.1);
      border-radius: 4px;
      overflow: hidden;
      margin-bottom: 8px;
    }
    .progress-fill {
      height: 100%;
      background: var(--ok);
      width: 33%;
      transition: width 0.3s ease;
    }
    .progress-labels {
      display: flex;
      justify-content: space-between;
      font-size: 11px;
      color: var(--muted);
    }
    .progress-labels span.active-label {
      font-weight: 700;
      color: var(--text);
    }
    .form-step {
      animation: fadeIn 0.4s ease;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(5px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .step-nav {
      margin-top: 20px;
      border-top: 1px solid var(--border);
      padding-top: 15px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    /* MEJORA 2: Ley de Postel (Feedback visual) */
    .field input:focus, .field textarea:focus {
        border-color: var(--link);
    }

    /* MEJORA 3: Ley de Fitts (Jerarqu√≠a Visual y Botones) */
    .final-actions {
        margin-top: 25px;
        padding-top: 20px;
        border-top: 1px solid var(--border);
        display: flex;
        flex-direction: column;
        gap: 15px;
        align-items: center;
    }
    
    /* Bot√≥n H√©roe (Guardar): Grande y f√°cil de clicar */
    .btn-hero {
        width: 100%;
        padding: 15px 25px;
        font-size: 1.1rem;
        font-weight: 800;
        text-transform: uppercase;
        letter-spacing: 1px;
        background: var(--ok);
        color: #0e1220;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        box-shadow: 0 4px 15px rgba(55, 214, 122, 0.4);
        transition: transform 0.2s, box-shadow 0.2s;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
    }
    .btn-hero:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(55, 214, 122, 0.6);
        background: #4af28f;
    }

    /* Bot√≥n Texto (Cancelar): Discreto para evitar errores */
    .btn-text {
        background: transparent;
        border: none;
        color: var(--muted);
        text-decoration: underline;
        font-size: 0.9rem;
        cursor: pointer;
        padding: 10px;
    }
    .btn-text:hover {
        color: var(--danger);
    }

    @media (min-width: 600px) {
        .final-actions {
            flex-direction: row;
            justify-content: space-between;
        }
        .btn-hero {
            width: auto;
            min-width: 220px;
            order: 2;
        }
        .btn-text {
            order: 1;
        }
        .step-buttons-group {
            display: flex;
            gap: 10px;
            align-items: center;
            order: 2;
        }
    }
  </style>
</head>

<body>
<header>
  <div class="topbar">
    <div class="brand">LegacyCRM <small>v0.3 (Mejorado)</small></div>
    <input id="globalSearch" placeholder="Buscar... (no funciona bien)" />
    <div class="pill" id="btnSync">Sincronizar</div>
    <div class="pill ok" id="btnHelp">Ayuda</div>
    <div class="pill danger" id="btnLogout">Salir</div>
  </div>
</header>

<div class="wrap">
  <aside>
    <nav class="menu" id="menu">
      <h3>Men√∫</h3>
      <a href="#dashboard" data-route="dashboard" class="active">Dashboard <small>Resumen confuso</small></a>
      <a href="#clientes" data-route="clientes">Clientes <small>Optimizado</small></a>
      <a href="#oportunidades" data-route="oportunidades">Oportunidades <small>Campos innecesarios</small></a>
      <a href="#config" data-route="config">Configuraci√≥n <small>Opciones raras</small></a>
      <a href="#reportes" data-route="reportes">Reportes <small>Exporta a ".csvv"</small></a>
    </nav>

    <div class="friction" title="Indicador did√°ctico de fricci√≥n (sube con mala UX)">
      <div class="meter"><i id="frictionBar"></i></div>
      <div class="txt" id="frictionTxt">Fricci√≥n: 8% (tolerable)</div>
    </div>

    <p class="note" style="margin:10px 6px 0;">
      <strong style="color:#aab0c3">Nota:</strong> Esta app est√° dise√±ada para ser <em>frustrante</em> a prop√≥sito.
    </p>
  </aside>

  <main>
    <section id="view-dashboard" class="view">
      <div class="grid">
        <div class="card">
          <div class="hd">
            <h2>Actividad Reciente</h2>
            <div class="meta">√öltima actualizaci√≥n: <span id="lastUpdate">hace 47 min</span></div>
          </div>
          <div class="bd">
            <table>
              <thead>
                <tr>
                  <th>Evento</th><th>Usuario</th><th>Estado</th><th>Notas</th>
                </tr>
              </thead>
              <tbody id="activityTbody"></tbody>
            </table>
            <p class="note">Tip (malo): "si no entiendes, prueba hacer clic en todo".</p>
          </div>
        </div>

        <div class="card">
          <div class="hd">
            <h2>Alertas del Sistema</h2>
            <div class="meta">Prioridad: Alta (siempre)</div>
          </div>
          <div class="bd" id="alertsBox">
            <div class="tag bad">ERROR #A-17</div>
            <div class="tag warn">WARNING</div>
            <div class="tag bad">TIMEOUT</div>
            <p class="note" style="margin-top:10px">
              Mensajes ambiguos para aumentar ansiedad.
            </p>
            <ul style="margin:8px 0 0; padding-left:16px; font-size:11px; color:var(--muted)">
              <li>"Algo sali√≥ mal. Intenta m√°s tarde."</li>
              <li>"Permisos insuficientes (¬øcu√°les?)"</li>
              <li>"Sesi√≥n por expirar (sin opci√≥n clara de extender)"</li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <section id="view-clientes" class="view" style="display:none">
      <div class="card">
        <div class="hd">
          <h2>Registrar Cliente</h2>
          <div class="meta">Mejoras: Agrupamiento + Postel + Fitts</div>
        </div>
        <div class="bd">

          <div class="progress-container">
            <div class="progress-bar">
              <div class="progress-fill" id="progressBar"></div>
            </div>
            <div class="progress-labels">
              <span class="active-label">1. Datos</span>
              <span>2. Contacto</span>
              <span>3. Finalizar</span>
            </div>
          </div>

          <p class="note">
            Formulario optimizado para reducir carga cognitiva y errores.
          </p>

          <div class="form" id="clientForm">
            
            <div id="step-1" class="form-step">
                <h3>Paso 1: Datos de la Entidad</h3>
                <div class="field">
                    <label>Nombre legal completo *</label>
                    <input id="c_name" placeholder="Ingrese nombre completo" />
                    <div class="help" style="color:var(--ok)">‚úì Admitimos caracteres especiales (√ë, tildes).</div>
                </div>

                <div class="field">
                    <label>RFC/RUC/NIT/ID Fiscal *</label>
                    <input id="c_tax" placeholder="Ej: 0000000000000" />
                    <div class="help">Debe tener 13, 14 o 15 d√≠gitos.</div>
                </div>

                <div class="field">
                    <label>Industria *</label>
                    <select id="c_industry">
                        <option value="">Seleccione...</option>
                        <option>Servicios varios</option>
                        <option>Industria 4.0</option>
                        <option>Comercio minorista</option>
                        <option>Comercio mayorista</option>
                        <option>Educaci√≥n</option>
                    </select>
                </div>

                <div class="field">
                    <label>Tipo de cliente *</label>
                    <select id="c_type">
                        <option value="">Seleccione...</option>
                        <option>VIP</option>
                        <option>Normal</option>
                        <option>Riesgo</option>
                        <option>Prueba</option>
                    </select>
                </div>

                <div class="actions step-nav">
                    <div></div> <button class="primary" onclick="changeStep(2)">Siguiente ‚ûú</button>
                </div>
            </div>

            <div id="step-2" class="form-step" style="display:none;">
                <h3>Paso 2: Informaci√≥n de Contacto</h3>
                <div class="field">
                    <label>Correo corporativo *</label>
                    <input id="c_email" placeholder="name@empresa.com" />
                    <div class="help">Rechazamos correos personales (gmail).</div>
                </div>

                <div class="field">
                    <label>Tel√©fono (Flexible) *</label>
                    <input id="c_phone" placeholder="Ej: 099 123 4567" />
                    <div class="help" style="color:var(--ok)">‚úì Escriba como quiera (nosotros formateamos).</div>
                </div>

                <div class="field">
                    <label>Direcci√≥n (m√≠n. 120 caracteres) *</label>
                    <textarea id="c_address" placeholder="Calle, n√∫mero, referencia, sector, etc..."></textarea>
                </div>

                <div class="actions step-nav">
                    <button class="secondary" onclick="changeStep(1)">‚¨Ö Atr√°s</button>
                    <button class="primary" onclick="changeStep(3)">Siguiente ‚ûú</button>
                </div>
            </div>

            <div id="step-3" class="form-step" style="display:none;">
                <h3>Paso 3: Confirmaci√≥n</h3>
                <div class="field">
                    <label>Notas internas (obligatorio) *</label>
                    <textarea id="c_notes" placeholder="Escribe algo..."></textarea>
                </div>

                <div class="field">
                    <label>Consentimiento *</label>
                    <div style="display:flex; align-items:center; gap:10px; padding:5px;">
                        <input id="c_consent" type="checkbox" style="width:auto; transform:scale(1.2)" />
                        <span style="font-size:11px; color:var(--muted)">He le√≠do y acepto los t√©rminos.</span>
                    </div>
                </div>

                <div class="field">
                    <label>Captcha *</label>
                    <input id="c_captcha" placeholder="Resuelva la suma..." />
                </div>

                <div class="final-actions">
                    <button id="btnCancelClient" class="btn-text">Cancelar operaci√≥n</button>
                    
                    <div class="step-buttons-group">
                        <button class="secondary" onclick="changeStep(2)">‚¨Ö Atr√°s</button>
                        <button id="btnSubmitClient" class="btn-hero">
                            <span>üíæ Guardar Cliente</span>
                        </button>
                    </div>
                </div>
            </div>

          </div>
        </div>
      </div>
    </section>

    <section id="view-oportunidades" class="view" style="display:none">
      <div class="card">
        <div class="hd">
          <h2>Oportunidades (pipeline)</h2>
          <div class="meta">Filtros: <em>no recordados</em></div>
        </div>
        <div class="bd">
          <p class="note">Tabla extensa sin paginaci√≥n adecuada y con estados poco claros.</p>
          <table>
            <thead>
              <tr>
                <th>Cuenta</th><th>Monto</th><th>Prob.</th><th>Etapa</th><th>Acciones</th>
              </tr>
            </thead>
            <tbody id="oppsTbody"></tbody>
          </table>
          <div class="actions">
            <button id="btnNewOpp" class="primary">Nueva oportunidad</button>
            <button id="btnExport">Exportar .csvv</button>
          </div>
        </div>
      </div>
    </section>

    <section id="view-config" class="view" style="display:none">
      <div class="card">
        <div class="hd">
          <h2>Configuraci√≥n</h2>
          <div class="meta">Cuidado: cambios irreversibles</div>
        </div>
        <div class="bd">
          <p class="note">
            Opciones innecesarias y peligrosas, sin confirmaciones claras (mala UX intencional).
          </p>
          <div class="form">
            <div class="field">
              <label>Modo del sistema</label>
              <select id="sysMode">
                <option>Productivo (pero lento)</option>
                <option>Productivo (pero con errores)</option>
                <option>Experimental (rompe cosas)</option>
              </select>
              <div class="help">No hay documentaci√≥n.</div>
            </div>
            <div class="field">
              <label>Auto-cierre de sesi√≥n</label>
              <select id="autoLogout">
                <option value="30">30 segundos</option>
                <option value="60">1 minuto</option>
                <option value="120">2 minutos</option>
              </select>
              <div class="help">S√≠, es absurdamente corto.</div>
            </div>
          </div>
          <div class="actions">
            <button id="btnApplyConfig" class="primary">Aplicar</button>
            <button id="btnNuke" class="danger">Restablecer TODO</button>
          </div>
        </div>
      </div>
    </section>

    <section id="view-reportes" class="view" style="display:none">
      <div class="card">
        <div class="hd">
          <h2>Reportes</h2>
          <div class="meta">Generaci√≥n: "cuando quiera"</div>
        </div>
        <div class="bd">
          <p class="note">
            Reportes sin contexto, sin filtros claros, y con tiempos de carga simulados.
          </p>
          <div class="actions" style="justify-content:flex-start">
            <button id="btnRunReport" class="primary">Generar Reporte</button>
            <button id="btnRunReport2">Generar Reporte (lento)</button>
          </div>
          <div id="reportOutput" class="note" style="margin-top:12px; white-space:pre-wrap;"></div>
        </div>
      </div>
    </section>

    </main>
</div>

<div class="toast" id="toast">
  <strong id="toastTitle">Aviso</strong>
  <p id="toastMsg">Mensaje confuso.</p>
  <div class="bar"><i></i></div>
</div>

<div class="modal-backdrop" id="modalBackdrop" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true">
    <div class="hd">
      <h3 id="modalTitle">Encuesta obligatoria</h3>
      <button id="modalX" class="danger">X</button>
    </div>
    <div class="bd">
      <p>Para continuar, responda (sin motivo). Cerrar puede perder cambios.</p>
      <div class="row">
        <div class="field">
          <label>¬øQu√© tan satisfecho est√°? *</label>
          <select id="m_q1">
            <option value="">Seleccione...</option>
            <option>Muy satisfecho</option>
            <option>Neutral</option>
            <option>Frustrado</option>
          </select>
        </div>
        <div class="field">
          <label>¬øRecomendar√≠a el sistema? *</label>
          <select id="m_q2">
            <option value="">Seleccione...</option>
            <option>S√≠</option>
            <option>No</option>
            <option>No s√©</option>
          </select>
        </div>
      </div>
      <div class="field" style="margin-top:10px">
        <label>Comentario (m√≠n. 80 caracteres) *</label>
        <textarea id="m_comment" placeholder="Escriba un comentario extenso..."></textarea>
        <div class="help">S√≠, es obligatorio y largo.</div>
      </div>
    </div>
    <div class="ft">
      <button id="btnModalSubmit" class="primary">Enviar</button>
      <button id="btnModalLater">Despu√©s (pero te insistir√°)</button>
    </div>
  </div>
</div>

<script src="script.js"></script>
</body>
</html>